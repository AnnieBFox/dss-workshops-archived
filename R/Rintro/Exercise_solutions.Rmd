---
title: "Exercise Solutions"
output: ioslides_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, results = FALSE)
library(readr)
library(dplyr)
library(ggplot2)
```

## Exercise 0

```{r, purl = FALSE}
## 1. 2 plus 2
2 + 2
## or
sum(2, 2)

## 2. square root of 10:
sqrt(10)
## or
10^(1/2)


## 3. Find "An Introduction to R".

## Go to the main help page by running 'help.start() or using the GUI
## menu, find and click on the link to "An Introduction to R".

```

## Exercise 1: Reading data
```{r, results = FALSE, message = FALSE, purl = FALSE}
## The first step of our analysis of baby names is to read the data into R. 

## 1. Start by opening the help page for the `read_csv` function so you can refer
## to the documentation if needed.

?read_csv

## 2. Read the baby names using the `read_csv` function and assign the result 
## with the name `baby.names`.

baby.names <- read_csv("http://tutorials.iq.harvard.edu/data/babyNames.csv")

## 3. BONUS (optional): Using 
## https://github.com/rstudio/cheatsheets/raw/master/data-import.pdf 
## as a guide, save the `baby.names` data as a Stata data set `babynames.dta` 
## and as an R data set `babynames.rds`.

# install.packages("haven")
library(haven)
write_dta(baby.names, "babynames.dta")

write_rds(baby.names, "babynames.rds")
```

## Exercise 2: Peak popularity of your name

```{r, purl = FALSE}
# 1.  Use `filter` to extract data for your name (or another name of your choice).  

george <- filter(baby.names, Name == "george")

# 2.  Arrange the data you produced in step 1 above by `Count`. 
#     In which year was the name most popular?

arrange(george, desc(Count))
 
# 3.  BONUS (optional): Identify the most popular boys name in 1999.

arrange(filter(baby.names, Year == 1996 & Sex == "Male"),
        desc(Count))

```

## Exercise 3: Data manipulation
```{r, purl = FALSE}

# 1.  Use `mutate` and `group_by` to create a column named "Proportion"
#     where `Proportion = Count/sum(Count)` for each `Year X Sex` group.

baby.names <- mutate(group_by(baby.names, Year, Sex),
                     Proportion = Count/sum(Count))

## 2.  Create a column named "Popular" containing `TRUE` in 
##     rows where "Proportion" is greater than 0.02 and a `FALSE` 
##     otherwise.

baby.names <- mutate(baby.names,
                     Popular = Proportion > 0.02)

# 3.  Filter the baby names data to display only the popular names.

filter(baby.names, Popular)

```

## Exercise 4: Group by and summarize

```{r, purl = FALSE}
## 1.  Calculate the total number of children born.
baby.names <- ungroup(baby.names)
summarize(baby.names, Total = sum(Count))

## 2.  Calculate the number of boys and girls born each year.
##     Assign the result
##     to the name `births.by.year`.
births.by.year <- summarize(group_by(baby.names, Year, Sex),
                            Count = sum(Count))
births.by.year

## 3. How many children were born in 2004?
summarize(filter(births.by.year, Year == 2004),
          total = sum(Count))
```


## Exercise 5: Popularity of the most popular names

```{r, purl = FALSE}
### 1.  Filter the baby.names data, retaining only the most 
##      popular girl and boy names for each year.

most.popular <- filter(group_by(baby.names, Year, Sex),
                       Proportion == max(Proportion))


## 2.  Plot proportion over time to see changes in the proportion
##     who chose the most popular name of the year.

qplot(data = most.popular, 
      x = Year, 
      y = Proportion, 
      color = Sex, 
      geom = "line")
```